<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial hierarchy analysis. — spatial_hier • epiphy</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial hierarchy analysis. — spatial_hier"><meta property="og:description" content='The manner in which the data are collected provides information about
aggregation of disease at different levels in a spatial hierarchy (Hughes et
al. 1997). For example, a sampling unit (upper level) can be reported as
"healthy", if no diseased leaves (lower level) were found within the sampling
unit.'><meta property="og:image" content="https://chgigot.github.io/epiphy/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epiphy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/epiphy.html">Primer</a>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/defs-and-eqns.html">Definitions and relationships between parameters</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/chgigot/epiphy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial hierarchy analysis.</h1>
    <small class="dont-index">Source: <a href="https://github.com/chgigot/epiphy/blob/HEAD/R/spatial-hier.R" class="external-link"><code>R/spatial-hier.R</code></a></small>
    <div class="hidden name"><code>spatial_hier.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The manner in which the data are collected provides information about
aggregation of disease at different levels in a spatial hierarchy (Hughes et
al. 1997). For example, a sampling unit (upper level) can be reported as
"healthy", if no diseased leaves (lower level) were found within the sampling
unit.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatial_hier</span><span class="op">(</span><span class="va">low</span>, <span class="va">high</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>low</dt>
<dd><p>An list of <code>intensity</code> objects.</p></dd>


<dt>high</dt>
<dd><p>An list of <code>intensity</code> objects.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>spatial_hier</code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In a pairwise comparison between levels, the probability that an individual
at the lower hierarchical level is diseased is denoted plow, and phigh refers
to the probability of disease at the higher level. The relationship between
these two probabilities can be written as</p>
<p>phigh = 1 - (1 - plow)^nu</p>
<p>where n is a parameter ranging from 0 to the corresponding number of
individuals at the hierarchical level referenced by plow. If the value of n
is equal to the number of individuals at the lower hierarchical level
contained in a unit of the higher level (n low ), this suggests that there is
no aggregation of disease incidence at the lower level. Conversely, a value
of n less than n low is indicative of aggregation at that level. The value of
n can be interpreted as an effective sample size (Hughes and Gottwald 1999;
Madden and Hughes 1999) in the statistical sense that its value indicates the
number of independent pieces of information at the lower level. Here, the
effective sample size concerns the equating of the zero-term of the binomial
distribution with the zero-term of an overdispersed distribution, as
described in Madden and Hughes (1999). Using the complementary log-log
transformation, CLL(x) = ln(-ln(1-x)), one can rewrite the Equation 5 as
follows (Madden et al. 2007):</p>
<p>CLL(phigh) = ln(nu) + CLL(plow)</p>
<p>from which the value of ln(n) can be obtained as the intercept of a linear
regression when the slope is constrained to 1.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_data_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="intensity.html">incidence</a></span><span class="op">(</span><span class="va">tomato_tswv</span><span class="op">$</span><span class="va">field_1929</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_data_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="clump.html">clump</a></span><span class="op">(</span><span class="va">my_data_low</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_data_high</span> <span class="op">&lt;-</span> <span class="va">my_data_low</span></span></span>
<span class="r-in"><span><span class="va">my_data_high</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">my_data_high</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">my_data_high</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_data_low</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">my_data_low</span>, by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_data_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">my_data_high</span>, by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">spatial_hier</span><span class="op">(</span><span class="va">my_data_low</span>, <span class="va">my_data_high</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Only 3 cloglog data points were used to perform the regression.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial hierarchy analysis for 'incidence' data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter estimate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_nu 2.000362  0.1198758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nu     7.391731  0.8860894</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spatial_hier(low = my_data_low, high = my_data_high)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.02779  0.19234 -0.22013 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_nu   2.0004     0.1199  16.687  0.00357 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nu       7.3917     0.8861   8.342  0.01407 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.2076 on 2 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatial_hier-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Gigot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

