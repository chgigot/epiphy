<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epiphy">
<title>Analyzing plant disease epidemics with the R package epiphy • epiphy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing plant disease epidemics with the R package epiphy">
<meta property="og:description" content="epiphy">
<meta property="og:image" content="https://chgigot.github.io/epiphy/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epiphy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/epiphy.html">Primer</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and data</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/defs-and-eqns.html">Definitions and relationships between parameters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chgigot/epiphy/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing plant disease epidemics with the R package epiphy</h1>
                        <h4 data-toc-skip class="author">Christophe
Gigot</h4>
            
            <h4 data-toc-skip class="date">2023-11-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chgigot/epiphy/blob/HEAD/vignettes/epiphy.Rmd" class="external-link"><code>vignettes/epiphy.Rmd</code></a></small>
      <div class="d-none name"><code>epiphy.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This paper presents the R package <strong>epiphy</strong> which
provides a common framework for spatialized plant disease intensity data
collected at one or more time points. Many statistical methods developed
over the last decades to describe and quantify plant disease epidemics
are implemented. The paper is an introduction to the framework concepts
and the provided tools using different sample codes to illustrate
possible workflows.</p>
<p><strong>Keywords:</strong> plant disease epidemics, phytopathology,
spatial data, spatial aggregation, aggregation index, beta-binomial
distribution, Taylor’s power law, binary power law, spatial hierarchy
analysis, SADIE, R.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Performing analyses of plant disease intensity data is a common task
for many field phytopathologists. Different softwares have been
developped to make computationally available some statistical methods,
but there are separated programs and are sometimes restricted to a
specific computer system.</p>
<p>This paper describes the version 0.5.0 of the package
<strong>epiphy</strong> for R <span class="citation">(R Core Team
2015)</span>, which offers an uniform and coherent framework to perform
spatial analyses in plant disease epidemics. Efforts were made to ensure
that the users can fluently and fluidly carry out the data analyses that
meet their needs, making it possible to generalize and automate such
tasks, and piece together a sequence of operations, while limiting the
need for reimplementing methods described in the scientific literature
to save time and reduce the potential for error. Another key advantage
of this package is to allow users unfamiliar with these methods
(e.g. students, other scientists) to use them with safeguards against
misuses of methods specific for a given kind of data set for instance.
While firstly intented to be a toolbox for phytopathologists,
implemented methods may be easily translatable to other data
contexts.</p>
<p>This package consists of three components: a bundle of historical
data sets in plant disease epidemiology, a set of relevant data classes
to reliably and efficiently handle date sets, and statistical methods
developped over the last few decades to extract information from
collected data sets. Information about these different components are
given in this paper, but the main amphasis is made on the practical
tools using code examples.</p>
<p>As the <strong>epiphy</strong> package is not yet available on CRAN,
one needs to use the following lines to install it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co"># If not already installed.</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"chgigot/epiphy"</span><span class="op">)</span> <span class="co"># Note: Same command for the updates.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chgigot/epiphy" class="external-link">epiphy</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-sets">Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h2>
<p>The package <strong>epiphy</strong> is provided with a bundle of more
than 10 historical data sets that were mainly published in plant disease
epidemiology literature. There is, for example, counts of arthropods
made in a wheat field in UK in 1996 <span class="citation">(Holland,
Winder, and Perry 1999)</span> or incidence of tomato spotted wilt virus
(TSWV) disease recorded in field trials at the Waite Institute
(Australia) in 1929 <span class="citation">(Cochran 1936)</span>. These
two data sets (called <code>arthropods</code> and
<code>tomato_tswv$field_1929</code> in <strong>epiphy</strong>) will be
used throughout this paper. To take a look at all the available data
sets, type <code>data(package = "epiphy")</code>. Each data set is
supported by relevant documentation specifying briefly the context of
data collection, the data structure and the published references. Note
that you do not need to use the function <code>data</code> to load a
provided data set because all of them are already lazily loaded when
<strong>epiphy</strong> is loaded. This means that they will not occupy
any memory until you use them.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">arthropods</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    378 obs. of  6 variables:</span></span>
<span><span class="co">##  $ x : int  1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span><span class="co">##  $ y : int  1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span><span class="co">##  $ xm: int  0 30 60 90 120 150 180 0 30 60 ...</span></span>
<span><span class="co">##  $ ym: int  0 0 0 0 0 0 0 30 30 30 ...</span></span>
<span><span class="co">##  $ t : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ i : int  29 32 2 24 20 10 26 21 25 12 ...</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tomato_tswv</span><span class="op">$</span><span class="va">field_1929</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    4320 obs. of  5 variables:</span></span>
<span><span class="co">##  $ x: int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ y: int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ t: int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ i: int  0 1 0 1 0 0 0 0 1 0 ...</span></span>
<span><span class="co">##  $ n: int  1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre>
<p>In these two examples, <span class="math inline">\(x\)</span> and
<span class="math inline">\(y\)</span> correspond to the spatial
coordinates of the sampling units distributed in a regular
two-dimensional grid. Specifically <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the row id and the within-row
sampling unit id, respectively. <span class="math inline">\(t\)</span>
variable stands for the assessment time or date. There are six and three
recording dates for the counts of arthropods and the TSWV incidence data
sets, respectively. <span class="math inline">\(i\)</span> variable
corresponds to the number of recorded individuals (arhtropods or
diseased plants) in each sampling unit. <span class="math inline">\(n\)</span>, which is only there in incidence data
sets, is the total number of individuals in a sampling unit. As in the
raw TSWV incidence data set, <span class="math inline">\(n = 1\)</span>
everywhere, this means that each sampling unit contains only one plant
and so <span class="math inline">\(i\)</span> can only be equal to 0
(the plant is healthy) or 1 (the plant is diseased).</p>
</div>
<div class="section level2">
<h2 id="conceptual-framework">Conceptual framework<a class="anchor" aria-label="anchor" href="#conceptual-framework"></a>
</h2>
<p>In order to collect spatial plant disease data, an appropriate
sampling unit (or quadrat or sample unit or cluster) corresponding to a
location where assessments are carried out must be chosen. It may be a
plant unit (typically a leaf in the case of foliar pathogens), an
indivudal plant or a cluster of nearby plants. The different ways of
recording disease levels (or disease intensity) were sometimes confusing
in the literature. We strive to stick to the nomenclature proposed by
<span class="citation">McRoberts, Hughes, and Madden ( 2003)</span>
where the count of visible symptoms (such as lesions), the presence or
absence of disease, and the assessment of the proportion of plant tissue
diseased correspond to count, incidence and severity data, respectively.
To reliably handle such kinds of observational data sets, the package
<strong>epiphy</strong> relies on the definition of a set of relevant
classes. There is a mother class, named <code>intensity</code>, which
makes it possible to format disease data sets for further analyses and
check that everything is fine with the provided data (e.g. the input
data must be a data frame). Object creation is only possible for one of
the three subclasses of <code>intensity</code> which are
<code>count</code>, <code>incidence</code> and <code>severity</code> for
eponymous kinds of data. (Note that there is no implemented methods for
the <code>severity</code> class at the moment.) Count data are integers
starting from zero with no upper limit, while incidence data differ only
by a upper limit set equal to the number of individuals in the sampling
unit. Severity data correspond to percentages ranging from 0 to
100%.</p>
<p>When creating an object of one of the subclasses of
<code>intensity</code>, it is necessary to perform variable mapping to
describe how variables in the input data frame will be mapped to
spatial, temporal and observational properties of the analysis methods
described in a later section. The reserved variable names for spatial
information correspond to the three spatial dimensions, <code>x</code>,
<code>y</code> and <code>z</code>. (Note that no currently implemented
method deals with the third dimension <code>z</code>). <code>t</code> is
used to map temporal information. Finally, <code>i</code> and
<code>n</code> are reserved for the so-called observational properties.
They stand for recorded intensity and number of individuals in a
sampling unit, respectively. Variable mapping can be implicit, if (some
of) the reserved names are already present in the column names of the
input data frame, or explicit, if the user make the links between the
reserved names and the column names using the function
<code>mapping</code>. Note that this paradigm is similar to the one used
in <strong>ggplot2</strong> package with the function
<code>aes</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count data</span></span>
<span><span class="co"># We will use only the last assessment date for the arthropods data set:</span></span>
<span><span class="va">arthropods_t6</span> <span class="op">&lt;-</span> <span class="va">arthropods</span><span class="op">[</span><span class="va">arthropods</span><span class="op">$</span><span class="va">t</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="co"># - Explicit mapping:</span></span>
<span><span class="op">(</span><span class="va">cou_t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">count</a></span><span class="op">(</span><span class="va">arthropods_t6</span>, <span class="fu"><a href="../reference/mapping.html">mapping</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, t <span class="op">=</span> <span class="va">t</span>, i <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A mapped object: count class</span></span>
<span><span class="co">## # dim: 2 space, 1 time, 1 obs</span></span>
<span><span class="co">##   [x] [y]   .  . [t] [i]</span></span>
<span><span class="co">##     x   y  xm ym   t   i</span></span>
<span><span class="co">## 1   1   1   0  0   3   3</span></span>
<span><span class="co">## 2   2   1  30  0   3  26</span></span>
<span><span class="co">## 3   3   1  60  0   3  10</span></span>
<span><span class="co">## 4   4   1  90  0   3   8</span></span>
<span><span class="co">## 5   5   1 120  0   3  16</span></span>
<span><span class="co">## 6   6   1 150  0   3  12</span></span>
<span><span class="co">## # ... with 57 more records (rows)</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># - Total implicit mapping:</span></span>
<span><span class="va">cou_t3_bis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">count</a></span><span class="op">(</span><span class="va">arthropods_t6</span><span class="op">)</span></span>
<span><span class="co"># - Partial implicit mapping:</span></span>
<span><span class="va">cou_t3_ter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">count</a></span><span class="op">(</span><span class="va">arthropods_t6</span>, <span class="fu"><a href="../reference/mapping.html">mapping</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">cou_t3</span>, <span class="va">cou_t3_bis</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">cou_t3</span>, <span class="va">cou_t3_ter</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Implicit mapping for incidence data:</span></span>
<span><span class="op">(</span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">incidence</a></span><span class="op">(</span><span class="va">tomato_tswv</span><span class="op">$</span><span class="va">field_1929</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A mapped object: incidence class</span></span>
<span><span class="co">## # dim: 2 space, 1 time, 2 obs</span></span>
<span><span class="co">##   [x] [y] [t] [i] [n]</span></span>
<span><span class="co">##     x   y   t   i   n</span></span>
<span><span class="co">## 1   1   1   1   0   1</span></span>
<span><span class="co">## 2   1   2   1   1   1</span></span>
<span><span class="co">## 3   1   3   1   0   1</span></span>
<span><span class="co">## 4   1   4   1   1   1</span></span>
<span><span class="co">## 5   1   5   1   0   1</span></span>
<span><span class="co">## 6   1   6   1   0   1</span></span>
<span><span class="co">## # ... with 4314 more records (rows)</span></span></code></pre>
<p>Some useful information are displayed when you print an
<code>intensity</code> object, such as the exact nature of this object
(<code>count</code>, <code>incidence</code> or <code>severity</code>).
Mapping variables (with squared brackets) and mapped variables (just
below mapping variables) are also printed. You can also plot such
objects to vizualize all the data in a convenient way.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cou_t3</span>, tile <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/plot_count-1.png" width="672"></p>
<p><strong>Figure 1.</strong> Observation sequences of maps of of the
counts of arthropods over time.</p>
<p>It is possible to perform useful data transformation directly with
<code>intensity</code> objects. For example, the <code>clump</code>
function can be used to regroup adjacent sampling units into bigger
ones, and thus redefine what is a sampling unit in a given data set. An
extended version of <code>split</code> was also implemented to deal with
<code>intensity</code> objects in an efficient way. In addition, you can
use <code>as.data.frame</code> anytime you want to retrieve the
underlying data frame of an <code>intensity</code> object (without any
mapping).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clump.html">clump</a></span><span class="op">(</span><span class="va">inc</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc9</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/utilities_intensity-1.png" width="672"><img src="epiphy_files/figure-html/utilities_intensity-2.png" width="672"></p>
<p><strong>Figure 2.</strong> Observation sequences of maps of TSWV
incidence data over time for two definition of a sampling unit. A
sampling unit contains either only one tomato plant
(<strong>above</strong>), or a set of 9 plants (<strong>below</strong>).
In each case, the three maps correspond to the same field at different
dates.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc9_t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">inc9</span>, by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">inc9_t1_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">inc9_t1</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc9_t1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc9_t1_sub</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/unnamed-chunk-1-1.png" width="288"><img src="epiphy_files/figure-html/unnamed-chunk-1-2.png" width="288"></p>
<p><strong>Figure 3.</strong> Different sub-parts of the TSWV incidence
data set, with only what was observed for the first scoring time
(<strong>left</strong>) and for a subpart of this same scoring time
(<strong>right</strong>).</p>
</div>
<div class="section level2">
<h2 id="statistical-methods">Statistical methods<a class="anchor" aria-label="anchor" href="#statistical-methods"></a>
</h2>
<p>A collection of statistical methods has been implemented in
<strong>epiphy</strong>. At the moment, the available tools include
several indices of aggregation (e.g. Fisher’s, Lloyd’s and Morisita’s
indices), distribution fitting to reveal any spatial aggregation in data
sets, power law analysis (Taylor’s and binary forms) and an early
version of Spatial Analysis by Distance IndicEs (SADIE). We strived to
mention most relevant scientific literature related to each method in
the corresponding R help pages.</p>
<p>Most of the time, a function dedicated to some methods is clever
enough to know which “flavor” of the method needs to be used with the
provided data set. For example, if you use the function
<code>power_law</code> with a <code>count</code> data set, the regular
Taylor’s power law will be called, whereas in the case of
<code>incidence</code> data, it will be the binary form of the power
law. That is the other reason why, in addition to performing initial
compliance tests, a set of dedicated classes was implemented to handle
different kinds of <code>intensity</code> data sets. In any case, the
function outputs will let you know what flavor was used to perform the
analysis.</p>
<div class="section level3">
<h3 id="aggregation-indices">Aggregation indices<a class="anchor" aria-label="anchor" href="#aggregation-indices"></a>
</h3>
<p>The index of aggregation for <code>incidence</code> data is
calculated by default when the <code>agg_index</code> function is used
with such a data set.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">inc9_t1_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agg_index.html">agg_index</a></span><span class="op">(</span><span class="va">inc9_t1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fisher's index of dispersion:</span></span>
<span><span class="co">## (Version for incidence data)</span></span>
<span><span class="co">## 1.4</span></span></code></pre>
<p>If this function is called with <code>count</code> data, the
corresponding version of this index (also called Fisher’s index of
aggregation) is calculated. Other indices may be calculated with
<code>agg_index</code>, such as Lloyd’s index of patchiness and
Morisita’s coefficient of dispersion. The index calculated by default
can be tested using a chi-squared test, a z-test or a c(<span class="math inline">\(\alpha\)</span>) test.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">inc9_t1_idx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Chi-squared test for (N - 1)*index following a chi-squared distribution</span></span>
<span><span class="co">##  (df = N - 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  inc9_t1_idx</span></span>
<span><span class="co">## X-squared = 222.56, df = 159, p-value = 0.0006578</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/z.test.html">z.test</a></span><span class="op">(</span><span class="va">inc9_t1_idx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One-sample z-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  inc9_t1_idx</span></span>
<span><span class="co">## z = 3.7803, p-value = 0.0001566</span></span>
<span><span class="co">## alternative hypothesis: two.sided</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calpha.test.html">calpha.test</a></span><span class="op">(</span><span class="va">inc9_t1_idx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  C(alpha) test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  inc9_t1_idx</span></span>
<span><span class="co">## z = 3.7092, p-value = 0.0002079</span></span></code></pre>
<p>In this example, the null hypothesis of non-aggregation is
rejected.</p>
</div>
<div class="section level3">
<h3 id="distribution-fitting">Distribution fitting<a class="anchor" aria-label="anchor" href="#distribution-fitting"></a>
</h3>
<p>As its name implies, the function <code>fit_two_distr</code> try to
fit two different distributions to a given data set. One distribution is
supposed to be representative of a random pattern, while the second one
should denote an aggregated pattern. For <code>count</code> data, the
default distributions are Poisson and negative binomial for random and
aggregated patterns, respectively. For <code>incidence</code> data, the
default distributions are binomial and beta-binomial for random and
aggregated patterns, respectively <span class="citation">(Hughes and
Madden 1993; Madden and Hughes 1995)</span>. In the latter case,
<code>fit_two_distr</code> may be viewed as an alternative to the BBD
software <span class="citation">(Madden and Hughes 1994)</span>. Note
that <strong>epiphy</strong> provides also a set of handy functions to
work with the beta-binomial distribution (<code>dbetabinom</code>,
<code>pbetabinom</code>, <code>qbetabinom</code> and
<code>rbetabinom</code>).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cou_t3_distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_two_distr.html">fit_two_distr</a></span><span class="op">(</span><span class="va">cou_t3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cou_t3_distr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of two distributions by maximum likelihood</span></span>
<span><span class="co">## for 'count' data.</span></span>
<span><span class="co">## Parameter estimates:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (1) Poisson (random):</span></span>
<span><span class="co">##        Estimate  Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## lambda 11.68254  0.43062  27.129 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (2) Negative binomial (aggregated):</span></span>
<span><span class="co">##       Estimate   Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## k     3.308038  0.742318  4.4564 8.336e-06 ***</span></span>
<span><span class="co">## mu   11.682540  0.916690 12.7443 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## prob  0.220675  0.040883  5.3977 6.748e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc9_t1_distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_two_distr.html">fit_two_distr</a></span><span class="op">(</span><span class="va">inc9_t1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">inc9_t1_distr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Fitting of two distributions by maximum likelihood</span></span>
<span><span class="co">## for 'incidence' data.</span></span>
<span><span class="co">## Parameter estimates:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (1) Binomial (random):</span></span>
<span><span class="co">##      Estimate  Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## prob 0.181250 0.010151  17.855 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (2) Beta-binomial (aggregated):</span></span>
<span><span class="co">##        Estimate   Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## alpha  3.671093  1.457761  2.5183  0.011792 *  </span></span>
<span><span class="co">## beta  16.574710  6.665468  2.4867  0.012895 *  </span></span>
<span><span class="co">## prob   0.181326  0.011913 15.2204 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## rho    0.047068  0.017943  2.6232  0.008711 ** </span></span>
<span><span class="co">## theta  0.049393  0.019759  2.4997  0.012428 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cou_t3_distr</span>, breaks <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc9_t1_distr</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/fit_distributions-1.png" width="288"><img src="epiphy_files/figure-html/fit_distributions-2.png" width="288"></p>
<p><strong>Figure 4.</strong> Frequency distributions of the count of
arthropods in a wheat field in UK on 12 July 1996
(<strong>left</strong>), and the incidence of TSWV disease in a tomato
field in Australia on 18 December 1930 (<strong>right</strong>). The
assessments of arthropods counts and TSWV incidence were reported by
<span class="citation">Perry et al. ( 1999)</span> and <span class="citation">Cochran ( 1936)</span>, respectively. The black bars
represent observed frequencies, the grey bars represent expected
aggregated frequencies (negative binomial on the <strong>left</strong>
and beta-binomial on the <strong>right</strong>), and the white bars
represent expected random frequencies (Poisson on the
<strong>left</strong> and binomial on the <strong>right</strong>).</p>
</div>
<div class="section level3">
<h3 id="power-law">Power law<a class="anchor" aria-label="anchor" href="#power-law"></a>
</h3>
<p>Taylor’s power law can be used to assess the overall degree of
heterogeneity in a collection of <code>count</code> data sets at the
sampling-unit scale <span class="citation">(Taylor 1961)</span>. A
binary form of this power law was proposed to deal with
<code>incidence</code> data <span class="citation">(Hughes and Madden
1992)</span>. Taylor’s and binary power laws describe the relationship
between the observed variance of diseased individuals (or individuals of
interest) within a data set and the corresponding variance under the
assumption that the data have a random distribution distribution (i.e.,
Poisson and binomial for <code>count</code> and <code>incidence</code>
data, respectively).</p>
<p>For the sake of illustration, the count of arthropods will be
splitted into data sets of 9 sampling units each (3 rows <span class="math inline">\(\times\)</span> 3 sampling units <span class="math inline">\(\times\)</span> 1 recording date) before
performing Taylor’s power law analysis on this data set. To also give an
example use of the binary form of the power law, we will split the TSWV
incidence data into data sets of 20 sampling units each (4 rows <span class="math inline">\(\times\)</span> 5 sampling units of 9 plants each
<span class="math inline">\(\times\)</span> 1 recording date) in order
to also simulate a collection of different data sets.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cou</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">count</a></span><span class="op">(</span><span class="va">arthropods</span><span class="op">[</span><span class="va">arthropods</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">6</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cou</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">cou</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cou_plaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_law.html">power_law</a></span><span class="op">(</span><span class="va">cou</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cou_plaw</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                             Estimate Std. Error    t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept): log_base(Ar) -0.1191721  0.5650426 -0.2109082 8.342179e-01</span></span>
<span><span class="co">## log(x): b                  1.5752164  0.2010455  7.8351249 4.035639e-09</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc9_spl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">inc9</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inc_plaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_law.html">power_law</a></span><span class="op">(</span><span class="va">inc9_spl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">inc_plaw</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                             Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept): log_base(Ar)  0.5533101 1.04346689 0.5302613 6.012425e-01</span></span>
<span><span class="co">## log(x): b                  1.0994981 0.27222117 4.0389883 5.484494e-04</span></span>
<span><span class="co">## Ai                         1.7389998 1.81458867 0.9583438 3.483037e-01</span></span>
<span><span class="co">## ai                         0.1552786 0.06965083 2.2293866 3.631573e-02</span></span>
<span><span class="co">## AI                         1.1230753 0.19158067 5.8621535 6.727429e-06</span></span>
<span><span class="co">## aI                        12.5775689 5.64171735 2.2293866 3.631573e-02</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cou_plaw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc_plaw</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/power_laws-1.png" width="288"><img src="epiphy_files/figure-html/power_laws-2.png" width="288"></p>
<p><strong>Figure 5.</strong> Relationship between the logarithm of the
observed variance and the logarithm of the theoretical variance for
counts of arthropods carryied out in UK (<strong>left</strong>) and
incidence data of TSWV disease collected in Australia
(<strong>right</strong>). Solid lines indicate the linear relationship
(on logarithmic axes) between observed and theoretical random variances.
Dashed lines indicate the cases where both variances are equal (which
suggests an absence of aggregation).</p>
</div>
<div class="section level3">
<h3 id="spatial-hierarchy">Spatial hierarchy<a class="anchor" aria-label="anchor" href="#spatial-hierarchy"></a>
</h3>
<p>To carry out spatial hierarchy analyses <span class="citation">(Hughes et al. 1997)</span>, it is necessary to prepare
the existing data sets. To do so, the <code>threshold</code> function is
of primary interest. As in graphics editors, it allows to “simplify” the
image in the sense that every value below and above a given threshold is
given the value 0 and 1, respectively. By default, everything above 0 is
given 1, and 0 stays at 0. <code>threshold</code> is thus useful to
report a whole sampling unit as “healthy” (0), if no diseased individual
at all was found within the sampling unit, or “diseased” (1) if at least
one diseased individual was found.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc9_t1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/threshold.html">threshold</a></span><span class="op">(</span><span class="va">inc9_t1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/threshold_function-1.png" width="288"><img src="epiphy_files/figure-html/threshold_function-2.png" width="288"></p>
<p><strong>Figure 6.</strong> Disease incidence of TSWV for sampling
units consisting in 9 tomato plants, at the plant level
(<strong>left</strong>) and the sampling unit level
(<strong>right</strong>). These figures were made using the intensively
mapped TSWV incidence data reported by <span class="citation">Cochran (
1936)</span> for the first assessment performed on 18 December 1929.</p>
<p>For the sake of illustration, the TSWV incidence data reported by
<span class="citation">Cochran ( 1936)</span> will be first splitted
into data sets of 20 sampling units each (4 rows <span class="math inline">\(\times\)</span> 5 sampling units of 9 plants each
<span class="math inline">\(\times\)</span> 1 recording date) to
simulate a collection of different <code>incidence</code> data sets.
Then, disease incidence at the sampling unit level will be calculated,
before performing a spatial hierarchy analysis.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc_low</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">inc9</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">5</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inc_high</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">inc_low</span>, <span class="va">threshold</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">inc_sphier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatial_hier.html">spatial_hier</a></span><span class="op">(</span><span class="va">inc_low</span>, <span class="va">inc_high</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Spatial hierarchy analysis for 'incidence' data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameter estimate:</span></span>
<span><span class="co">##        Estimate Std. Error</span></span>
<span><span class="co">## log_nu 2.052793 0.08445315</span></span>
<span><span class="co">## nu     7.789630 0.65785878</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inc_sphier</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/spatial_hierarchies-1.png" width="672"></p>
<p><strong>Figure 7.</strong> Relationship between the incidences of
TSWV disease at the tomato plant and sampling unit level (made of 9
plants) in a two level spatial hierarchy where the sampling unit is the
highest level and the plant is the lowest level. Dashed curve is the
binomial fit to the data and the solid curve is the beta-binomial fit to
the data. This graph is based on 24 data sets of the incidence of TSWV
disease collected in 1929 in field trials in Australia.</p>
</div>
<div class="section level3">
<h3 id="spatial-analysis-by-distance-indices-sadie">Spatial Analysis by Distance IndicEs (SADIE)<a class="anchor" aria-label="anchor" href="#spatial-analysis-by-distance-indices-sadie"></a>
</h3>
<p>This two-dimensional geostatistical approach uses the relative
locations of the sampling units and the number of diseased individuals
per sampling unit to quantify the spatial arrangement of diseased
individuals by calculating the distance to regularity <span class="citation">(Perry 1995)</span>. Regularity is defined as the state
where each sampling unit of a given data set contains the same number of
diseased individuals (i.e., the mean number of diseased individuals for
this data set). The SADIE procedure uses a transportation algorithm to
calculate the distance to regularity, and performs a randomization test
to determine if an observed distance to regularity is particularly small
or large. <strong>epiphy</strong> implements an early version of a
cross-plateform SADIE procedure.</p>
<p>To perform a SADIE analysis, the spatial coordinates must reflect the
real relative distances between the different sampling units. If you
mapped <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables to grid coordinates, you can
use the <code>remap</code> function to map them to metric coordinates
(if any in your data set).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cou_t3_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mapping.html">remap</a></span><span class="op">(</span><span class="va">cou_t3</span>, <span class="fu"><a href="../reference/mapping.html">mapping</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xm</span>, y <span class="op">=</span> <span class="va">ym</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cou_t3_m</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sadie.html">sadie</a></span><span class="op">(</span><span class="va">cou_t3_m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computation of Perry's indices:</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## sadie.count(data = cou_t3_m)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## First 6 rows of clustering indices:</span></span>
<span><span class="co">##     x y  i cost_flows      idx_P idx_LMX prob</span></span>
<span><span class="co">## 1   0 0  3  -30.00000 -0.4708909      NA   NA</span></span>
<span><span class="co">## 2  30 0 26   40.23662  0.7460930      NA   NA</span></span>
<span><span class="co">## 3  60 0 10  -53.08882 -1.2326789      NA   NA</span></span>
<span><span class="co">## 4  90 0  8    0.00000  0.0000000      NA   NA</span></span>
<span><span class="co">## 5 120 0 16   30.00000  0.7601079      NA   NA</span></span>
<span><span class="co">## 6 150 0 12   30.00000  0.8107080      NA   NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary indices:</span></span>
<span><span class="co">##                       overall    inflow  outflow</span></span>
<span><span class="co">## Perry's index        1.171517 -1.310935 1.073955</span></span>
<span><span class="co">## Li-Madden-Xu's index       NA        NA       NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main outputs:</span></span>
<span><span class="co">## Ia: 1.1414 (Pa = 0.14)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 'Total cost': 1274.105</span></span>
<span><span class="co">## Number of permutations: 100</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, isoclines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/sadie-1.png" width="672"><img src="epiphy_files/figure-html/sadie-2.png" width="672"><img src="epiphy_files/figure-html/sadie-3.png" width="672"></p>
<p><strong>Figure 8.</strong> Maps of clustering indices with index
symbols alone (<strong>top</strong>) or with interpolated landscape and
contours (<strong>bottom</strong>). For the <strong>top</strong> map,
symbols filled with blue (receivers) and red (donors) color indicate
that absolute values of Perry’s indices are &gt; 1.5.</p>
</div>
<div class="section level3">
<h3 id="map-comparison-mapcomp">Map comparison (MAPCOMP)<a class="anchor" aria-label="anchor" href="#map-comparison-mapcomp"></a>
</h3>
<p>The MAPCOMP procedure proposed by <span class="citation">Lavigne et
al. ( 2010)</span> relies on the calculation of the Hellinger distance
between the density map of recorded intensity data and the density map
of sampling effort.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mapcomp.html">mapcomp</a></span><span class="op">(</span><span class="va">cou_t3_m</span>, delta <span class="op">=</span> <span class="fl">4</span>, bandwidth <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## Map Comparison analysis (mapcomp)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## mapcomp.count(data = cou_t3_m, delta = 4, bandwidth = 60)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Stat: 0.0989 (P = 0.019802)</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/mapcomp-1.png" width="672"></p>
<p><strong>Figure 9.</strong> Density map.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The package <strong>epiphy</strong> implements currently many of the
methods described in the chapter 9 of the book “The study of plant
disease epidemics” <span class="citation">(Madden, Hughes, and Bosch
2007)</span>. We hope that such statistical methods packaged in a
consistent way to be easily used in an open statistical environment will
facilitate their use and spread in the phytopathology community, and
even beyond.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>The authors are grateful to Prof. Xiangming Xu for discussion and
advice regarding the SADIE procedure.</p>
</div>
<div class="section level2">
<h2 id="annexes">Annexes<a class="anchor" aria-label="anchor" href="#annexes"></a>
</h2>
<p>Most of the functions in the package <strong>epiphy</strong> have
been designed to be compatible with pipeline coding. Using the package
<strong>magrittr</strong>, you can pipe the analyses as in the following
examples.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chgigot/epiphy" class="external-link">epiphy</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/intensity.html">incidence</a></span><span class="op">(</span><span class="va">tomato_tswv</span><span class="op">$</span><span class="va">field_1929</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extract.html" class="external-link">getElement</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># To keep the first assessment time.</span></span>
<span>    <span class="fu"><a href="../reference/clump.html">clump</a></span><span class="op">(</span>unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fit_two_distr.html">fit_two_distr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/pipe_analyses-1.png" width="672"></p>
<pre><code><span><span class="co">## Fitting of two distributions by maximum likelihood</span></span>
<span><span class="co">## for 'incidence' data.</span></span>
<span><span class="co">## Parameter estimates:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (1) Binomial (random):</span></span>
<span><span class="co">##      Estimate  Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## prob 0.181250 0.010151  17.855 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (2) Beta-binomial (aggregated):</span></span>
<span><span class="co">##        Estimate   Std.Err Z value    Pr(&gt;z)    </span></span>
<span><span class="co">## alpha  3.671093  1.457761  2.5183  0.011792 *  </span></span>
<span><span class="co">## beta  16.574710  6.665468  2.4867  0.012895 *  </span></span>
<span><span class="co">## prob   0.181326  0.011913 15.2204 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## rho    0.047068  0.017943  2.6232  0.008711 ** </span></span>
<span><span class="co">## theta  0.049393  0.019759  2.4997  0.012428 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>For information, below are the same analyses without pipes.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intensity.html">incidence</a></span><span class="op">(</span><span class="va">tomato_tswv</span><span class="op">$</span><span class="va">field_1929</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">my_data</span>, by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">my_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clump.html">clump</a></span><span class="op">(</span><span class="va">my_data</span>, unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_res</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_two_distr.html">fit_two_distr</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_res</span><span class="op">)</span></span></code></pre></div>
<p>Here is another example:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/intensity.html">count</a></span><span class="op">(</span><span class="va">arthropods</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/clump.html">clump</a></span><span class="op">(</span>unit_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">agg_index</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>    <span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span> <span class="va">xx</span><span class="op">$</span><span class="va">index</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>                      xlab <span class="op">=</span> <span class="st">"Observation sequence"</span>,</span>
<span>                      ylab <span class="op">=</span> <span class="st">"Aggregation index"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiphy_files/figure-html/pipes2-1.png" width="672"></p>
<pre><code><span><span class="co">##            1            2            3            4            5            6 </span></span>
<span><span class="co">## 1.523216e-07 5.594987e-08 1.549744e-07 2.979618e-13 9.080714e-19 3.287662e-07</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-Cochran_1936" class="csl-entry">
Cochran, W. G. 1936. <a href="https://doi.org/10.2307/2983677" class="external-link">The
statistical analysis of field counts of diseased plants</a>. Supplement
to the Journal of the Royal Statistical Society 3:49–67.
</div>
<div id="ref-Holland_etal_1999" class="csl-entry">
Holland, J. M., Winder, L., and Perry, J. N. 1999. Arthropod prey of
farmland birds: Their spatial distribution within a sprayed field with
and without buffer zones. Aspects of Applied Biology 54:53–60.
</div>
<div id="ref-Hughes_Madden_1992" class="csl-entry">
Hughes, G., and Madden, L. V. 1992. <a href="https://doi.org/10.1111/j.1365-3059.1992.tb02549.x" class="external-link">Aggregation
and incidence of disease</a>. Plant Pathology 41:657–660.
</div>
<div id="ref-Hughes_Madden_1993" class="csl-entry">
Hughes, G., and Madden, L. V. 1993. Using the beta-binomial distribution
to describe aggegated patterns of disease incidence. Phytopathology
83:759–763.
</div>
<div id="ref-Hughes_etal_1997" class="csl-entry">
Hughes, G., McRoberts, N., Madden, L. V., and Gottwald, T. R. 1997. <a href="https://doi.org/10.1094/PHYTO.1997.87.5.542" class="external-link">Relationships between
disease incidence at two levels in a spatial hierarchy</a>.
Phytopathology 87:542–550.
</div>
<div id="ref-Lavigne_etal_2010" class="csl-entry">
Lavigne, C., Ricci, B., Franck, P., and Senoussi, R. 2010. <a href="https://doi.org/10.1016/j.baae.2010.08.011" class="external-link">Spatial analyses of
ecological count data: A density map comparison approach</a>. Basic and
Applied Ecology 11:734–742.
</div>
<div id="ref-Madden_Hughes_1994" class="csl-entry">
Madden, L. V., and Hughes, G. 1994. BBD — computer software for fitting
the beta-binomial distribution to disease incidence data. Plant Disease
78:536–540.
</div>
<div id="ref-Madden_Hughes_1995" class="csl-entry">
Madden, L. V., and Hughes, G. 1995. <a href="https://doi.org/10.1146/annurev.py.33.090195.002525" class="external-link">Plant disease
incidence: Distributions, heterogeneity, and temporal analysis</a>.
Annual Review of Phytopathology 33:529–564.
</div>
<div id="ref-Madden_etal_2007" class="csl-entry">
Madden, L. V., Hughes, G., and Bosch, F. van den. 2007. <em>The study of
plant disease epidemics</em>. American Phytopathological Society St
Paul, <span>MN</span>.
</div>
<div id="ref-McRoberts_etal_2003" class="csl-entry">
McRoberts, N., Hughes, G., and Madden, L. V. 2003. <a href="https://doi.org/10.1111/j.1744-7348.2003.tb00242.x" class="external-link">The
theoretical basis and practical application of relationships between
different disease intensity measurements in plants</a>. Annals of
Applied Biology 142:191–211.
</div>
<div id="ref-Perry_1995" class="csl-entry">
Perry, J. N. 1995. <a href="https://doi.org/10.2307/5892" class="external-link">Spatial
analysis by distance indices</a>. Journal of Animal Ecology 64:303–314.
</div>
<div id="ref-Perry_etal_1999" class="csl-entry">
Perry, J. N., Winder, L., Holland, J. M., and Alston, R. D. 1999. <a href="https://doi.org/10.1046/j.1461-0248.1999.22057.x" class="external-link">Red–blue plots
for detecting clusters in count data</a>. Ecology Letters 2:106–113.
</div>
<div id="ref-R_core_team_2015" class="csl-entry">
R Core Team. 2015. <em>R: A language and environment for statistical
computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
Available at: <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-Taylor_1961" class="csl-entry">
Taylor, L. R. 1961. Aggregation, variance and the mean. Nature
189:732–735.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christophe Gigot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
